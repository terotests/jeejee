var _e_prototype=function(){"use strict";var t=function(){!function(t){t.attr=function(t,e){if(!isNaN(t))return void("undefined"!=typeof console&&"undefined"!=typeof console.trace&&(console.log("Attr set to ",t),console.trace()));if(this._host._svgElem){if(this._host.isObject(e)&&e.onValue){var i=this;return e.onValue(function(e){"undefined"!=typeof e&&null!==e&&("xlink:href"==t?i._dom.setAttributeNS("http://www.w3.org/1999/xlink","href",e):i._dom.setAttributeNS(null,t,e))}),this}if(this._host.isArray(e)){var n,r=e[0],o=e[1],s=r[o](),i=this,a=i._dom,h=this._host;return n="xlink:href"==t?h.uniqueListener("attr:"+t,function(t,e){"undefined"!=typeof e&&null!==e&&a.setAttributeNS("http://www.w3.org/1999/xlink","href",e)}):h.uniqueListener("attr:"+t,function(e,i){"undefined"!=typeof i&&null!==i&&a.setAttributeNS(null,t,i)}),r.on(o,n),"undefined"!=typeof s&&null!==s&&("xlink:href"==t?this._dom.setAttributeNS("http://www.w3.org/1999/xlink","href",s):this._dom.setAttributeNS(null,t,s)),this}if(this._host.isFunction(e)){var n,s=e(),r=e(null,!0),i=this,a=i._dom,h=this._host;return n="xlink:href"==t?h.uniqueListener("attr:"+t,function(t,e){"undefined"!=typeof e&&null!==e&&a.setAttributeNS("http://www.w3.org/1999/xlink","href",e)}):h.uniqueListener("attr:"+t,function(e,i){"undefined"!=typeof i&&null!==i&&a.setAttributeNS(null,t,i)}),r.me.on(r.name,n),"undefined"!=typeof s&&null!==s&&("xlink:href"==t?this._dom.setAttributeNS("http://www.w3.org/1999/xlink","href",s):this._dom.setAttributeNS(null,t,s)),this}return"undefined"!=typeof e&&("xlink:href"==t?this._dom.setAttributeNS("http://www.w3.org/1999/xlink","href",e):this._dom.setAttributeNS(null,t,e)),this}if(this._host.isObject(e)&&e.onValue){var i=this;return e.onValue(function(e){"undefined"!=typeof e&&null!==e&&("xlink:href"==t?i._dom.setAttributeNS("http://www.w3.org/1999/xlink","href",e):i._dom.setAttributeNS(null,t,e))}),this}if(this._host.isFunction(e)){var s=e(),r=e(null,!0),i=this,a=i._dom,h=this._host,n=h.uniqueListener("attr:"+t,function(e,i){"undefined"!=typeof i&&a.setAttribute(t,i)});return r.me.on(r.name,n),"undefined"!=typeof s&&isNaN(t)&&this._dom.setAttribute(t,s),this}return"undefined"!=typeof e&&isNaN(t)&&this._dom.setAttribute(t,e),this},t.bindSysEvent=function(t,e,i){if(t=t.toLowerCase(),this._sys||(this._sys={}),this._sys[t])return!1;this._sys[t]=!0;var n=this;return this._dom.attachEvent?this._dom.attachEvent("on"+t,function(t){t=t||window.event,n._event=t,e(),i&&(t=window.event,t&&(t.cancelBubble=!0))}):this._dom.addEventListener(t,function(t){t=t||window.event,n._event=t,i&&(t&&t.stopPropagation?t.stopPropagation():(t=window.event,t.cancelBubble=!0)),e()}),!0},t.blur=function(){this._dom.blur&&this._dom.blur()},t.css=function(t,e){return"background-color"==t&&(t="backgroundColor"),"margin-left"==t&&(t="marginLeft"),"font-size"==t&&(t="fontSize",e=this.pxParam(e)),("left"==t||"top"==t||"bottom"==t||"right"==t||"width"==t||"height"==t)&&(e=this.pxParam(e)),e.substring&&"NaN"==e.substring(0,3)?void 0:(this._dom.style[t]=e,this)},t.focus=function(){this._dom.focus&&this._dom.focus()},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(t,e){this._dom=t,this._host=e}),t.pxParam=function(t){if("auto"==t)return t;if("undefined"!=typeof t.slice){if("%"==t.slice(-1))return t;if("em"==t.slice(-2))return t;if("px"==t.slice(-2))return t}if(isNaN(parseInt(t)))return"";if("string"==typeof t)return parseInt(t)+"px";var e=parseInt(t);return isNaN(e)?void 0:e+"px"}}(this)},e=function(t,i,n,r,o,s,a,h){if(!(this instanceof e))return new e(t,i,n,r,o,s,a,h);var u=[t,i,n,r,o,s,a,h];if(this.__factoryClass){var f,c=this;if(this.__factoryClass.forEach(function(t){f=t.apply(c,u)}),"[object Function]"==Object.prototype.toString.call(f)){if(f._classInfo.name!=e._classInfo.name)return new f(t,i,n,r,o,s,a,h)}else if(f)return f}if(this.__traitInit){var c=this;this.__traitInit.forEach(function(t){t.apply(c,u)})}else"function"==typeof this.init&&this.init.apply(this,u)};e._classInfo={name:"_qc"},e.prototype=new t;var i=function(){!function(t){var e,i,n,r,o;t.add=function(t,e,n){if(e||n){var r;"[object Array]"===Object.prototype.toString.call(n)?r=n:(r=Array.prototype.slice.call(arguments,2),r||(r=[])),i.push([e,t,r])}else i.push(t)},t.after=function(t,e,i){i||(i="time"+(new Date).getTime()+Math.random(1e7)),r[i]={step:Math.floor(1e3*t),fn:e,nextTime:0,remove:!0}},t.asap=function(t){this.add(t)},t.every=function(t,e,i){i||(i="time"+(new Date).getTime()+Math.random(1e7)),r[i]={step:Math.floor(1e3*t),fn:e,nextTime:0}},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(){if(!e){this.polyfill();var t,s;if("undefined"!=typeof window){var t=window.requestAnimationFrame,s=window.cancelRequestAnimationFrame;["","ms","moz","webkit","o"].forEach(function(e){t||(t=window[e+"RequestAnimationFrame"],s=window[e+"CancelAnimationFrame"]||window[e+"CancelRequestAnimationFrame"])})}t||(t=function(t){return setTimeout(t,16)}),s||(s=function(t){clearTimeout(t)}),i=[],n={},r={},o=[];var a=0,h=function(){for(var e,s=(new Date).getTime();e=i.shift();)"[object Array]"===Object.prototype.toString.call(e)?e[1].apply(e[0],e[2]):e();for(var u=0;u<o.length;u++){var f=o[u];f()}for(var c in n)if(n.hasOwnProperty(c)){var d=n[c];d[0](d[1]),delete n[c]}for(var c in r)if(r.hasOwnProperty(c)){var d=r[c];d.nextTime<s&&(d.remove?d.nextTime>0?(d.fn(),delete r[c]):d.nextTime=s+d.step:(d.fn(),d.nextTime=s+d.step)),d.until&&d.until<s&&delete r[c]}t(h),a=s};h(),e=!0}}),t.once=function(t,e,i){n[t]=[e,i]},t.onFrame=function(t){o.push(t)},t.polyfill=function(){},t.removeFrameFn=function(t){var e=o.indexOf(t);return e>=0?(t._onRemove&&t._onRemove(),o.splice(e,1),!0):!1}}(this)},n=function(t,e,i,r,o,s,a,h){if(!(this instanceof n))return new n(t,e,i,r,o,s,a,h);var u=[t,e,i,r,o,s,a,h];if(this.__factoryClass){var f,c=this;if(this.__factoryClass.forEach(function(t){f=t.apply(c,u)}),"[object Function]"==Object.prototype.toString.call(f)){if(f._classInfo.name!=n._classInfo.name)return new f(t,e,i,r,o,s,a,h)}else if(f)return f}if(this.__traitInit){var c=this;this.__traitInit.forEach(function(t){t.apply(c,u)})}else"function"==typeof this.init&&this.init.apply(this,u)};n._classInfo={name:"later"},n.prototype=new i,"undefined"!=typeof window&&(window.later=n),"undefined"!=typeof window&&(window.later_prototype=i);var r=function(){var t=function(){!function(t){var e,i,n,r,o;t.add=function(t,e,n){if(e||n){var r;"[object Array]"===Object.prototype.toString.call(n)?r=n:(r=Array.prototype.slice.call(arguments,2),r||(r=[])),i.push([e,t,r])}else i.push(t)},t.after=function(t,e,i){i||(i="time"+(new Date).getTime()+Math.random(1e7)),r[i]={step:Math.floor(1e3*t),fn:e,nextTime:0,remove:!0}},t.asap=function(t){this.add(t)},t.every=function(t,e,i){i||(i="time"+(new Date).getTime()+Math.random(1e7)),r[i]={step:Math.floor(1e3*t),fn:e,nextTime:0}},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(){if(!e){this.polyfill();var t,s;if("undefined"!=typeof window){var t=window.requestAnimationFrame,s=window.cancelRequestAnimationFrame;["","ms","moz","webkit","o"].forEach(function(e){t||(t=window[e+"RequestAnimationFrame"],s=window[e+"CancelAnimationFrame"]||window[e+"CancelRequestAnimationFrame"])})}t||(t=function(t){return setTimeout(t,16)}),s||(s=function(t){clearTimeout(t)}),i=[],n={},r={},o=[];var a=0,h=function(){for(var e,s=(new Date).getTime();e=i.shift();)"[object Array]"===Object.prototype.toString.call(e)?e[1].apply(e[0],e[2]):e();for(var u=0;u<o.length;u++){var f=o[u];f()}for(var c in n)if(n.hasOwnProperty(c)){var d=n[c];d[0](d[1]),delete n[c]}for(var c in r)if(r.hasOwnProperty(c)){var d=r[c];d.nextTime<s&&(d.remove?d.nextTime>0?(d.fn(),delete r[c]):d.nextTime=s+d.step:(d.fn(),d.nextTime=s+d.step)),d.until&&d.until<s&&delete r[c]}t(h),a=s};h(),e=!0}}),t.once=function(t,e,i){n[t]=[e,i]},t.onFrame=function(t){o.push(t)},t.polyfill=function(){},t.removeFrameFn=function(t){var e=o.indexOf(t);return e>=0?(t._onRemove&&t._onRemove(),o.splice(e,1),!0):!1}}(this)},e=function(t,i,n,r,o,s,a,h){if(!(this instanceof e))return new e(t,i,n,r,o,s,a,h);var u=[t,i,n,r,o,s,a,h];if(this.__factoryClass){var f,c=this;if(this.__factoryClass.forEach(function(t){f=t.apply(c,u)}),"[object Function]"==Object.prototype.toString.call(f)){if(f._classInfo.name!=e._classInfo.name)return new f(t,i,n,r,o,s,a,h)}else if(f)return f}if(this.__traitInit){var c=this;this.__traitInit.forEach(function(t){t.apply(c,u)})}else"function"==typeof this.init&&this.init.apply(this,u)};e._classInfo={name:"later"},e.prototype=new t,"undefined"!=typeof window&&(window.later=e),"undefined"!=typeof window&&(window.later_prototype=t),function(t){t.guid=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},t.isArray=function(t){return"undefined"==typeof t?this.__isA:"[object Array]"===Object.prototype.toString.call(t)},t.isFunction=function(t){return"[object Function]"==Object.prototype.toString.call(t)},t.isObject=function(t){return"undefined"==typeof t?this.__isO:t===Object(t)}}(this),function(t){var i,n,r,o,s,a;t.hasOwnProperty("__factoryClass")||(t.__factoryClass=[]),t.__factoryClass.push(function(t){if(t||(t="_global_"),s){if(s[t])return s[t];s[t]=this}else s={},s[t]=this}),t.animation=function(t,e){var i=Array.prototype.slice.call(arguments),t=i.shift(),e=i.shift(),n=t+"-keyframes",r=0,o=this,s="";i.forEach(function(t){if(o.isObject(t)){var e=parseInt(100*r);s+=e+"% "+o.ruleToCss(t)+" \n",r=1}else r=t});var a="",h=["","-o-","-moz-","-webkit-"];h.forEach(function(t){a+="@"+t+"keyframes "+n+" { "+s+" } \n"}),this._animations[n]=a;if(this.isObject(e)){var u=this.animSettings(e);u["animation-name"]=n,this.bind("."+t,u)}else this.bind("."+t,{animation:n+" "+e})},t.animSettings=function(t){if(this.isObject(t)){var e={};for(var i in t)t.hasOwnProperty(i)&&(e["animation-"+i]=t[i]);return e}return{}},t.assign=function(t){var e,i={};return e=this.isArray(t)?t:Array.prototype.slice.call(arguments),e.forEach(function(t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])}),i},t.bind=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return this._data[e]=t,this._dirty=!0,this},t.buildCss=function(t){if(this._data){var e={};for(var i in this._data)if(this._data.hasOwnProperty(i)){var n=this._data[i];this._composedData[i]&&(n=[this._composedData[i]].concat(n)),e[i]=this.assign(n)}this._composedData=e,this.updateStyleTag(this.makeCss(e,t))}},t.collectAnimationCss=function(){var t=this._animations,e="";for(var i in t)t.hasOwnProperty(i)&&(e+=t[i]);return e},t.convert=function(t,e){var i,n="";if(e&&e.indexOf&&(i=e.indexOf("-gradient"))>=0){for(var r=i-1,s=i+8,a=!1,h="lineardg-wbktmozp";h.indexOf(e.charAt(r))>=0;)if(r--,0>=r){r=0;break}for(var u=1;"("!=e.charAt(s++););for(;u>0;)if("("==e.charAt(s)&&u++,")"==e.charAt(s)&&u--,s++,e.length<s){a=!0;break}if(!a){var f=e.substring(r,s),c=e.substring(0,r),d=e.substring(s),n="";["-webkit-","","-moz-","-o-"].forEach(function(e){n+=t+" : "+c+" "+e+f+d+";\n"})}}return o[t]?n=o[t](t,e):n+=t+" : "+e+";\n",n},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(t){if(this._data=this._data||{},this._animations={},this._composedData=this._composedData||{},this._postFix=t||"",!i){e().every(.1,function(){for(var t in s)if(s.hasOwnProperty(t)){var e=s[t];e._dirty&&(e.buildCss(),e._dirty=!1)}})}a||(a={});var n=t||"_global_";a[n]||(a[n]=!0,this.initConversions())}),t.initConversions=function(){i=document.getElementsByTagName("head")[0];var t=document.createElement("style");t.setAttribute("type","text/css"),t.styleSheet?t.styleSheet.cssText="":t.appendChild(document.createTextNode("")),i.appendChild(t),this._styleTag=t,n=function(t,e){var i="";return i+="-o-"+t+":"+e+";\n",i+="-moz-"+t+":"+e+";\n",i+="-webkit-"+t+":"+e+";\n",i+=t+":"+e+";\n"},r=function(t,e){var i="";return i+="-o-"+t+":-o-"+e+";\n",i+="-moz-"+t+":-moz-"+e+";\n",i+="-webkit-"+t+":-webkit-"+e+";\n",i+=t+":"+e+";\n"},o={"border-radius":function(t,e){return n(t,e)},"box-shadow":function(t,e){return n(t,e)},rotate:function(t,e){return t="transform",e="rotate("+parseInt(e)+"deg)",n(t,e)},transition:function(t,e){return r(t,e)},filter:function(t,e){return n(t,e)},animation:function(t,e){return n(t,e)},"animation-iteration-count":function(t,e){return n(t,e)},"animation-name":function(t,e){return n(t,e)},"animation-timing-function":function(t,e){return n(t,e)},"animation-duration":function(t,e){return n(t,e)},transform:function(t,e){return n(t,e)},"transform-style":function(t,e){return n(t,e)},"transform-origin":function(t,e){return n(t,e)},perspective:function(t,e){return n(t,e)},"text-shadow":function(t,e){return n(t,e)},opacity:function(t,e){e=parseFloat(e);var i='-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity='+parseInt(100*e)+')";';return i+="filter: alpha(opacity="+parseInt(100*e)+");",i+=n(t,e)}}},t.makeCss=function(t,e){var i=e?e+"{":"";for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];i+=n+this._postFix+this.ruleToCss(r)}return i+=this.collectAnimationCss(),i+=e?"}\n":""},t.ruleToCss=function(t){var e="{";for(var i in t)e+=this.convert(i,t[i]);return e+="}\n"},t.updateStyleTag=function(t){var e=this._styleTag,i=e.firstChild;if(e.styleSheet)e.styleSheet.cssText=t;else{var i=e.firstChild;e.appendChild(document.createTextNode(t)),"undefined"!=typeof i&&e.removeChild(i)}}}(this)},o=function(t,e,i,n,r,s,a,h){if(!(this instanceof o))return new o(t,e,i,n,r,s,a,h);var u=[t,e,i,n,r,s,a,h];if(this.__factoryClass){var f,c=this;if(this.__factoryClass.forEach(function(t){f=t.apply(c,u)}),"[object Function]"==Object.prototype.toString.call(f)){if(f._classInfo.name!=o._classInfo.name)return new f(t,e,i,n,r,s,a,h)}else if(f)return f}if(this.__traitInit){var c=this;this.__traitInit.forEach(function(t){t.apply(c,u)})}else"function"==typeof this.init&&this.init.apply(this,u)};o._classInfo={name:"css"},o.prototype=new r,"undefined"!=typeof window&&(window.css=o),"undefined"!=typeof window&&(window.css_prototype=r),function(t){t.add=function(t){t instanceof Array||(t=Array.prototype.slice.call(arguments,0));var e=this;return t.forEach(function(t){if(e.isFunction(t)){var i=_e(),n=t.apply(i,[e]);t=n?n:i}if("string"==typeof t||!isNaN(t)){var r=_e("span");return r._dom.innerHTML=t,e.add(r),e}if(e.isStream(t))return t.onValue(function(t){e.add(t)}),e;if("undefined"!=typeof t&&"undefined"!=typeof t._dom){t._parent&&t._parent.removeChild(t),e._children||(e._children=[]);var o=e._children.length;t._index=o,e._children.push(t),t._parent=e,t._svg=e._svg,e._dom.appendChild(t._dom),t.trigger("parent",e),e.trigger("child",t)}}),this},t.addItem=function(){var t=Array.prototype.slice.call(arguments,0);return this.add.apply(this,t)},t.clear=function(){for(this._children.forEach(function(t){t.remove()}),this._children=[];this._dom.firstChild;)this._dom.removeChild(this._dom.firstChild);return this},t.collectFromDOM=function(t){for(var e=_e(t),i=t.childNodes.length,n=t.attributes.length,r=0;n>r;r++){var o=t.attributes[r];e.q.attr(o.name,o.value)}var s=t.className;if(s){s+=" ";for(var a=s.split(" "),h=a.length,r=0;h>r;r++){var o=a[r];o&&e.addClass(o)}}(t.innerText||t.textContent)&&e.text(t.innerText||t.textContent);for(var r=0;i>r;r++){var u=t.childNodes[r];e.add(this.collectFromDOM(u))}return e},t.insertAfter=function(t){if(this._parent&&this._parent._children){if(t==this)return void console.log("The items were the same!!!");console.log("--- insert after ----");var e=this._index,i=this._parent._children;if(t._parent&&t._parent!=this._parent){t._parent.removeChild(t);var e=i.indexOf(this);i.splice(e+1,0,t),this._parent.reIndex()}else{if(t._parent){var n=i.indexOf(t);i.splice(n,1);var e=i.indexOf(this);console.log("--- insert placing into ",e+1," ----"),i.splice(e+1,0,t)}else t._parent=this._parent,i.splice(e+1,0,t);this._parent.reIndex()}var r=t._dom,o=this._dom;o.parentNode.insertBefore(r,o.nextSibling)}},t.insertAt=function(t,e){if(t<this._children.length){var i=this.child(t);i.insertBefore(e)}else this.add(e)},t.insertBefore=function(t){if(this._parent&&this._parent._children&&t!=this){var e=this._index,i=this._parent._children;if(t._parent&&t._parent!=this._parent){t._parent.removeChild(t),t._parent=this._parent;var e=i.indexOf(this);i.splice(e,0,t),this._parent.reIndex()}else{if(t._parent){var n=i.indexOf(t);n>=0&&i.splice(n,1);var e=i.indexOf(this);i.splice(e,0,t)}else t._parent=this._parent,i.splice(e,0,t);this._parent.reIndex()}var r=t._dom,o=this._dom;return o.parentNode.insertBefore(r,o),this}},t.moveDown=function(){if("undefined"!=typeof this._index&&this._parent){var t=this._index;if(!this._parent)return;if(!this._parent._children)return;if(t>=this._parent._children.length-1)return;if(this._parent._children){var e=this._parent._children[t+1];e._index--,this._index++;var i=this._parent._children;i.splice(t+1,0,i.splice(t,1)[0]);var n=e._dom,r=this._dom;r.parentNode.insertBefore(r,n.nextSibling)}}},t.moveUp=function(){if(this._index&&this._parent){var t=this._index;if(!t)return;if(0>=t)return;if(this._parent._children){var e=this._parent._children[t-1];e._index++,this._index--;var i=this._parent._children;i.splice(t-1,0,i.splice(t,1)[0]);var n=e._dom,r=this._dom;n.parentNode.insertBefore(r,n)}}},t.parent=function(){return this._parent},t.prepend=function(t){t instanceof Array||(t=Array.prototype.slice.call(arguments,0));var e=this;return t.forEach(function(t){if("string"==typeof t)return e._dom.innerHTML=t,e;if("undefined"!=typeof t&&"undefined"!=typeof t._dom){t._parent&&t._parent.removeChild(t),e._children||(e._children=[]),t._index=0,e._children.unshift(t),t._parent=e,e._dom.insertBefore(t._dom,e._dom.firstChild);for(var i=e._children.length,n=0;i>n;n++)e._children[n]._index=n;t.trigger("parent",e),e.trigger("child",t)}}),this},t.reIndex=function(){var t=this._children,e=0;t.forEach(function(t){t._index=e++})},t.remove=function(){if(this.removeChildEvents(),this._parent)this._parent.removeChild(this);else{var t=this._dom.parentElement;t&&t.removeChild(this._dom)}this._children=[],this.removeAllHandlers()},t.removeChild=function(t){if(this._children){var e=this._children.indexOf(t);e>=0&&(this._children.splice(e,1),this._dom.removeChild(t._dom)),this.reIndex()}},t.removeChildEvents=function(){this.forChildren(function(t){t.removeAllHandlers(),t.removeChildEvents(),t.removeControllersFor(t)})},t.removeIndexedChild=function(t){if(this._children){var e=this._children.indexOf(t);e>=0&&this._children.splice(e,1)}},t.replaceWith=function(t){var e=this.parent();if(e){var i=e._children.indexOf(this);e._dom.replaceChild(t._dom,this._dom),e._children.splice(i,1,t),t._parent=e,t._svg=this._svg}}}(this),function(t){var e;t.baconDrag=function(){var t=this;return Bacon.fromBinder(function(e){t.drag(function(t){e(t)})})},t.drag=function(t){var e=this,i={};if(this.isObject(t)&&!this.isFunction(t)){var n,r,o=t;t=function(t){t.start&&(n=o.x(),r=o.y()),o.x(n+t.dx).y(r+t.dy)}}return this.draggable(function(n,r){i.item=e,i.sx=r.x,i.sy=r.y,i.dx=0,i.dy=0,i.x=r.x,i.y=r.y,i.start=!0,i.end=!1,t(i)},function(e,n){i.start=!1,i.dx=n.dx,i.dy=n.dy,i.x=i.sx+i.dx,i.y=i.sy+i.dy,t(i)},function(e,n){i.end=!0,i.dx=n.dx,i.dy=n.dy,t(i)}),this},t.draggable=function(t,e,i){var n=this.__singleton();n.draggable(this),t&&this.on("startdrag",t),e&&this.on("drag",e),i&&this.on("enddrag",i)},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(){this._touchItems=[]}),t.mousePos=function(){e||(e={});var t=this.offset(),i=this.__singleton(),n=i.mouse();return e.sx=n.x,e.sy=n.y,e.x=n.x-t.left,e.y=n.y-t.top,e},t.pauseEvents=function(t){return t=t||window.event,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,!1},t.touch=function(t){return this._touchItems[t]},t.touchclick=function(){this.touchevents();this.on("touchstart",function(t){t.trigger("click")})},t.touchevents=function(){var t=this._dom;if(t.addEventListener){var e=this;this._touchItems=[];var i=function(t){e._touchItems=[];var i=t.touches;t.targetTouches&&(i=t.targetTouches),e._touchCount=i.length;for(var n=0;n<i.length;n++){var r={};r.startX=i[0].pageX,r.startY=i[0].pageY,e._touchItems[n]=r}e.trigger("touchstart"),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1},n=function(t){var i=t.touches;t.targetTouches&&(i=t.targetTouches),e._touchCount=i.length;for(var n=0;n<i.length;n++){var r=e._touchItems[n];r.dx=t.touches[n].pageX-r.startX,r.dy=t.touches[n].pageY-r.startY}e.trigger("touchmove"),t.preventDefault&&t.preventDefault()},r=function(t){e.trigger("touchend"),t.preventDefault&&t.preventDefault(),t.returnValue=!1};t.addEventListener("touchstart",i,!1),t.addEventListener("touchmove",n,!1),t.addEventListener("touchend",r,!1)}}}(this),function(t){t.absolute=function(){return this.q.css("position","absolute"),this.x(0).y(0).z(this.baseZ()),this},t.baseZ=function(t){return"undefined"!=typeof t?(this._baseZ=t,this):("undefined"==typeof this._baseZ&&(this._baseZ=0),this._baseZ)},t.box=function(){var t={left:0,top:0,width:800,height:800},e=this._dom;try{"undefined"!=typeof e.getBoundingClientRect&&(t=e.getBoundingClientRect())}catch(i){t={left:0,top:0,width:800,height:800}}return t},t.height=function(t){if("undefined"==typeof t)return this._h;if(this.isStream(t)){var e=this;return t.onValue(function(t){e.height(t)}),this}if(this.isFunction(t)){var i=t(!1,!0),e=this;return i.me.on(i.name,function(t,i){e.height(i)}),this.height(t()),this}if("auto"==t)return this._dom.style.height=t,this._h=t,this;if(t.slice){if("%"==t.slice(-1))return this._dom.style.height=t,this;if("em"==t.slice(-2))return this._dom.style.height=t,this}var n=this.pxParam(t);return"undefined"!=typeof n&&(this._dom.style.height=n),this},t.hoverLayer=function(t,e){var i=_e().absolute(),n=this.__singleton();i._dom.zIndex=e||1e5,t&&(i.addClass("Hoverlayer"),i.draggable(function(){console.log("hover, start drag")},function(){console.log("dragging ")},function(){console.log("end drag")}),i.bindSysEvent("mouseenter",function(){i.trigger("mouseenter")},!0),i.bindSysEvent("mouseleave",function(){i.trigger("mouseleave")},!0),i.bindSysEvent("click",function(){i.trigger("click")},!0),i.bindSysEvent("mousedown",function(){i.trigger("mousedown"),n.dragMouseDown(i)},!0),i.bindSysEvent("mouseup",function(){i.trigger("mouseup"),n.dragMouseUp()},!0));var r=this.offset();i.width(r.width),i.height(r.height);var o=_e().relative();return this.insertBefore(o),o.add(i),i},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(){}),t.offset=function(){var t=document.documentElement,e=(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0),i=(window.pageYOffset||t.scrollTop)-(t.clientTop||0),n=this.box();return{top:n.top+i,left:n.left+e,width:n.width,height:n.height}},t.pxParam=function(t){if("string"==typeof t)return parseInt(t)+"px";var e=parseInt(t);return isNaN(e)?void 0:e+"px"},t.relative=function(){return this.q.css("position","relative"),this.x(0).y(0).z(this.baseZ()),this},t.width=function(t){if("undefined"==typeof t)return this._w;if(this.isStream(t)){var e=this;return t.onValue(function(t){e.width(t)}),this}if(this.isFunction(t)){var i=t(!1,!0),e=this;return i.me.on(i.name,function(t,i){e.width(i)}),this.width(t()),this}if("auto"==t)return this._dom.style.width=t,this._w=t,this;if(t.slice){if("%"==t.slice(-1))return this._dom.style.width=t,this;if("em"==t.slice(-2))return this._dom.style.width=t,this}var n=this.pxParam(t);return"undefined"!=typeof n&&(this._dom.style.width=n),this},t.x=function(t){if(this.isStream(t)){var e=this;return t.onValue(function(t){e.x(t)}),this}if("undefined"!=typeof t){if(this._svgElem){var i=this.getTransform();this._y||(this._y=0),this._x||(this._x=0);var n=t-this._x;return this._x=t,0!=n&&(i.translate(n,0),this.q.attr("transform",i.getSvgTransform()),this.trigger("x")),this}return this.q.css("left",t+"px"),this._x=t,this.trigger("x"),this}return"undefined"==typeof this._x&&(this._x=0),this._x},t.y=function(t){if(this.isStream(t)){var e=this;return t.onValue(function(t){e.y(t)}),this}if("undefined"!=typeof t){if(this._svgElem){var i=this.getTransform();this._y||(this._y=0),this._x||(this._x=0);var n=t-this._y;return this._y=t,0!=n&&(i.translate(0,n),this.q.attr("transform",i.getSvgTransform()),this.trigger("y")),this}return this.q.css("top",t+"px"),this._y=t,this.trigger("y"),this}return"undefined"==typeof this._y&&(this._y=0),this._y},t.z=function(t){if(this.isStream(t)){var e=this;return t.onValue(function(t){e.z(t)}),this}var i=this._baseZ||0;return"undefined"!=typeof t?(this.q.css("zIndex",t+i),this._z=t,this.trigger("z"),this):("undefined"==typeof this._z&&(this._z=0),this._z)}}(this),function(t){var e;t.applyTransforms=function(t){var e=this._dom;return e.style.transform=t,e.style["-webkit-transform"]=t,e.style["-moz-transform"]=t,e.style["-ms-transform"]=t,this.trigger("transform"),this},t.compStyle=function(){var t=this._dom,e=window.getComputedStyle(t,null);return{get:function(t){return e.getPropertyValue(t)}}},t.createEffect=function(t,i,n,r){o().bind("."+t+"OutPosition",n),o().bind("."+t+"InPosition",i),r=r||{},r.duration=r.duration||.2,o().animation(t+"Out",{duration:2*r.duration.toFixed(2)+"s","iteration-count":1},i,.5,n,n),o().animation(t+"In",{duration:2*r.duration.toFixed(2)+"s","iteration-count":1},n,.5,i,i),e[t]=r},t.css=function(){return this._myClass||(this._myClass=this.guid(),this._css=o(this._myClass)),this._css},t.effectIn=function(t,i){if(this._effectOn||(this._effectOn={}),!this._effectOn[t]){if(!this._effectState)return this._effectState={},void(this._effectState[t]=1);if(1!=this._effectState[t]){this._effectOn[t]=(new Date).getTime();var r=e[t],o=t+"Out",s=t+"In",a=t+"InPosition",h=t+"OutPosition";this.removeClass(o),this.removeClass(s),this.addClass(s);var u=this;n().after(r.duration,function(){u.removeClass(h),u.addClass(a),u.removeClass(s),u._effectOn[t]=0,u._effectState[t]=1,i&&i()})}}},t.effectOut=function(t,i){if(this._effectOn||(this._effectOn={}),!this._effectOn[t]&&(this._effectState||(this._effectState={},this._effectState[t]=1),2!=this._effectState[t])){this._effectOn[t]=(new Date).getTime();var r=e[t],o=t+"Out",s=t+"In",a=t+"InPosition",h=t+"OutPosition";this.removeClass(o),this.removeClass(s),this.addClass(o);var u=this;n().after(r.duration,function(){u.removeClass(a),u.addClass(h),u.removeClass(o),u._effectOn[t]=0,u._effectState[t]=2,i&&i()})}},t.hide=function(){this._dom.style.display="none",this.trigger("hide")},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(){e||(e={})}),t.show=function(){this._dom.style.display="",this.trigger("show")},t.style=function(t){if(!this._localStyle){var e="localstyle"+(new Date).getTime()+"_"+guid();this._localStyle=o().css("width","auto"),this._localStyle.writeRule(e),this.addClass(e)}return this._localStyle},t.styleString=function(t){return this._dom.style.cssText=t,this},t.transform=function(t,e){this._transforms||(this._transforms=[]);{if("undefined"!=typeof e){if(-1==this._transforms.indexOf(t))this._transforms.push(t),this._transforms.push("("+e+")"),this._transforms.push(" ");else{var i=this._transforms.indexOf(t);this._transforms[i+1]="("+e+")"}var n=this._transforms.join("");return this.applyTransforms(n),this}if(this._transforms.indexOf(t)>=0){var i=this._transforms.indexOf(t),r=this._transforms[i+1],o=r.substr(1,r.length-2);return o}}},t.transformOrigin=function(t){var e=this._dom;return e.style["transform-origin"]=t,e.style["-webkit-transform-origin"]=t,e.style["-moz-transform-origin"]=t,e.style["-ms-transform-origin"]=t,this.trigger("transform-origin"),this},t.transformString=function(){return this._transforms?this._transforms.join(""):""}}(this),function(t){t.addRow=function(t){var e=new _e("tr");this.addItem(e),e.addClass("row"+this._children.length),"[object Array]"!==Object.prototype.toString.call(t)&&(t=Array.prototype.slice.call(arguments,0));var i=0,n=this;return t.forEach(function(t){var r=new _e("td");r._dom.setAttribute("valign","top"),n.isObject(t)?r.add(t):r.text(t),e.addItem(r),r.addClass("col"+i),i++}),this}}(this),function(t){t.child=function(t){return this._children[t]?this._children[t]:void 0},t.domAttrIterator=function(t,e){if(t&&t.attributes)for(var i=0;i<t.attributes.length;i++){var n=t.attributes[i];n.specified&&e(n.name,n.value)}},t.domIterator=function(t,e,i){if(t){var n={textarea:!0},r=t.childNodes;if(r)for(var o=r.length,s=0;o>s;s++){var a=r[s];if("svg"==a.tagName&&(i="svg"),a){var h=e(a,i);if(h);else{var u=a instanceof HTMLElement;if(u){var f=a.tagName.toLowerCase();n[f]||this.domIterator(a,e,i)}}}}}},t.forChildren=function(t){this._children&&this._children.forEach(function(e){t(e)})},t.forEach=function(t){this._children&&this._children.forEach(function(e){t(e)})},t.searchTree=function(t,e){e||(e=[]);var i;return(i=t(this))&&e.push(i),this._children&&this._children.forEach(function(i){i.searchTree(t,e)}),e}}(this),function(t){t.addClass=function(t){if(this._svg)return this;if(this._classes||(this._classes=[]),this.isStream(t)){var e=this,i="";return t.onValue(function(t){i&&t!=i&&e.removeClass(i),e.addClass(t),i=t}),this}var n=this.findPostFix();return n&&(this._classes.push(t+n),this._dom.className=this._classes.join(" ")),this._classes.push(t),this._dom.className=this._classes.join(" "),this},t.findPostFix=function(){if(this._myClass)return this._myClass;var t=this.parent();return t?t.findPostFix():""},t.hasClass=function(t){return this._classes&&this._classes.indexOf(t)>=0?!0:!1},t.removeClass=function(t){if(!this._classes)return this;for(var e;(e=this._classes.indexOf(t))>=0;)e>=0&&(this._classes.splice(e,1),this._dom.className=this._classes.join(" "));var i=this.findPostFix();if(i)for(;(e=this._classes.indexOf(t+i))>=0;)e>=0&&(this._classes.splice(e,1),this._dom.className=this._classes.join(" "));return this}}(this),function(t){var e;t.bacon=function(t,e){return Bacon.fromEvent(this._dom,t,e)},t.bindSysEvent=function(t,e,i){if(t=t.toLowerCase(),this._sys||(this._sys={}),this._sys[t])return!1;this._sys[t]=!0;var n=this;return this._dom.attachEvent?i?this._dom.attachEvent("on"+t,function(t){t=t||window.event,n._event=t,e(),i&&(t=window.event,t&&(t.cancelBubble=!0))}):this._dom.attachEvent("on"+t,e):i?this._dom.addEventListener(t,function(t){t=t||window.event,n._event=t,i&&(t&&t.stopPropagation?t.stopPropagation():(t=window.event,t.cancelBubble=!0)),e()}):this._dom.addEventListener(t,e),!0},t.delegate=function(t){this._delegates||(this._delegates=[]),this._delegates.push(t)},t.emitValue=function(t,e){return this._controller&&this._controller[t]?void this._controller[t](e):void(this._valueFn&&this._valueFn[t]?this._valueFn[t](e):this._parent&&this._parent.emitValue(t,e))},t.eventBinder=function(t,e,i,n){var r=this;t.attachEvent?t.attachEvent("on"+e,function(t){t=t||window.event,r._event=t,i(),n&&(t=window.event,t&&(t.cancelBubble=!0))}):t.addEventListener(e,function(t){t=t||window.event,r._event=t,n&&(t&&t.stopPropagation?t.stopPropagation():(t=window.event,t.cancelBubble=!0)),i()})},t.isHovering=function(){if(!this._hoverable){this._hovering=!1;var t=this;this.on("mouseenter",function(){t._hovering=!0}),this.on("mouseleave",function(){t._hovering=!1}),this._hoverable=!0}return this._hovering},t.namedListener=function(t,e){if("undefined"!=typeof e)return this._namedListeners||(this._namedListeners={}),this._namedListeners[t]=e,e._listenerName=t,this;if(this._namedListeners)return this._namedListeners[t]
},t.on=function(t,e){this._ev||(this._ev={}),this._ev[t]||(this._ev[t]=[]),this._ev[t].push(e);var i=this;if(e._unbindEvent=function(){i.removeListener(t,e)},"click"==t&&this.bindSysEvent("click",function(){i.trigger("click")},!0),"dblclick"==t&&this.bindSysEvent("dblclick",function(){i.trigger("dblclick")},!0),"mousedown"==t&&this.bindSysEvent("mousedown",function(){i.trigger("mousedown")}),"mouseup"==t&&this.bindSysEvent("mouseup",function(){i.trigger("mouseup")}),"checked"==t&&this.bindSysEvent("change",function(){"checkbox"==i._type?(i._checked=i._dom.checked?!0:!1,i.trigger("checked")):i._value=i._dom.value,i.trigger("value")}),"value"==t&&(this.bindSysEvent("change",function(){"checkbox"==i._type?(i._checked=i._dom.checked?!0:!1,i.trigger("checked")):i._value=i._dom.value,i.trigger("value")}),"input"==this._type||"textarea"==this._type)){var n="";this.bindSysEvent("keyup",function(){var t=!1;n!=i._dom.value&&(t=!0),i._value=i._dom.value,t&&i.trigger("value"),n=i._dom.value})}return"focus"==t&&this.bindSysEvent("focus",function(){i._value=i._dom.value,i.trigger("focus")}),"play"==t&&this.bindSysEvent("play",function(){i.trigger("play")}),"mousemove"==t&&this.bindSysEvent("mousemove",function(){i.trigger("mousemove")}),"blur"==t&&this.bindSysEvent("blur",function(){i._value=i._dom.value,i.trigger("blur")}),"mouseenter"==t&&(this._dom.attachEvent?(this.bindSysEvent("mouseenter",function(t){t=t||window.event,i._hover||(i._event=t,i._hover=!0,i.trigger("mouseenter"))}),this.bindSysEvent("mouseleave",function(t){t=t||window.event,i._hover&&(i._event=t,i._hover=!1,i.trigger("mouseleave"))})):(this.bindSysEvent("mouseover",function(t){t=t||window.event,i._hover||(i._hover=!0,i._event=t,i._parent&&(i._parent._hover||i._parent.trigger("mouseenter")),i.trigger("mouseenter"))}),this.bindSysEvent("mouseout",function(){if(i._hover){var t=!1;i.forChildren(function(e){e._hover&&(t=!0)}),t||(i._hover=!1,i.trigger("mouseleave"))}}))),this},t.onValue=function(t,e){this._valueFn||(this._valueFn={}),this._valueFn[t]=e},t.removeAllHandlers=function(){if(this._ev){for(var t in this._ev)if(this._ev.hasOwnProperty(t)){var e=this._ev[t],i=this;e.forEach(function(t){if(i._namedListeners){var e=t._listenerName;i._namedListeners[e]&&delete i._namedListeners[e]}t._unbindEvent&&t._unbindEvent()})}for(var t in this._namedListeners)if(this._namedListeners.hasOwnProperty(t)){var n=this._namedListeners[t];n._unbindEvent&&n._unbindEvent(),delete this._namedListeners[t]}}},t.removeListener=function(t,e){if(this._ev&&this._ev[t]){var i=this._ev[t].indexOf(e);i>=0&&this._ev[t].splice(i,1),0==this._ev[t].length&&delete this._ev[t]}},t.router=function(t,i){this._dom.addEventListener(t,function(t){var n=t.target;if(n){var r=n.getAttribute("data-routeid");if(r){var o=e[r];o&&i(o)}}})},t.setRoute=function(t,i){var n=this.guid();this._dom.setAttribute("data-routeid",n),e||(e={}),i&&this.forChildren(function(e){e.setRoute(t,i)}),e[n]=t},t.trigger=function(t,e,i){if(this._delegates&&this._delegates.forEach(function(n){n&&n.trigger&&n.trigger(t,e,i)}),this._ev&&this._ev[t]){var n=this;return this._ev[t].forEach(function(t){t(n,e,i)}),this}},t.uniqueListener=function(t,e){var i=this.namedListener(t);return i&&i._unbindEvent&&i._unbindEvent(),this.namedListener(t,e),e}}(this),function(t){t.bind=function(t,e){var i=this;if(this.isFunction(t[e])){{var n=t[e](),i=this,r=function(i){t[e](i)},o=!1,s=!1,a=this.uniqueListener("bind:valueIn",function(t,e){o||("checkbox"==i._type?i.checked(e):i.val(e),n=e)}),h=this.uniqueListener("bind:valueOut",function(t){console.log("Got value out for ",t,"which value was ",n),console.trace(),o=!0,r("checkbox"==i._type?i.checked():s?parseFloat(i.val()):i.val()),o=!1});this.uniqueListener("bind:invalidIn",function(t,e){i.trigger("invalid",e)}),this.uniqueListener("bind:validIn",function(t,e){i.trigger("valid",e)})}t.on(e,a),this.on("value",h);return"checkbox"==i._type?i.checked(n):i.val(n),this}var u=this.__singleton();u.bind(t,e,this);var i=this;return this.on("datachange",function(){"checkbox"==i._type?i.checked(t[e]?!0:!1):"undefined"!=typeof t[e]&&i.val(t[e])}),this.on("value",function(){t&&(t[e]="checkbox"==i._type?i.checked()?!0:!1:i.val()),u.send(t,e,"datachange",i)}),t&&("checkbox"==i._type?i.checked(t[e]?!0:!1):t[e]&&i.val(t[e])),i},t.blur=function(){this._dom.blur&&this._dom.blur()},t.checked=function(t){if("undefined"==typeof t)return this._checked=this._dom.checked,this._checked;var e=this._dom.checked;return this._dom.checked=t,(e&&!t||!e&&t)&&this.trigger("value"),this},t.clearOptions=function(){if(this._dataList){var t=this._dataList._dom;t.parentNode&&t.parentNode.removeChild(t),this._options={},this._dataList=null}},t.focus=function(){this._dom.focus&&this._dom.focus()},t.options=function(t){if("input"==this._tag){if(this._dataList){var e=this._dataList._dom;e.parentNode&&e.parentNode.removeChild(e),this._options={},this._dataList=null}if(!this._dataList){if(this._options={},this._dataList=_e("datalist"),this._dataListId=this.guid(),this._dataList.q.attr("id",this._dataListId),"[object Array]"===Object.prototype.toString.call(t)){var i=this;t.forEach(function(t){var e=_e("option");e.q.attr("value",t),e.text(t),i._options[t]=e,i._dataList.add(e)})}else for(var n in t)if(!this._options[n]&&t.hasOwnProperty(n)){var r=_e("option");r.q.attr("value",n),r.text(t[n]),this._options[n]=r,this._dataList.add(r)}this.q.attr("list",this._dataListId),document.body&&document.body.appendChild(this._dataList._dom)}}return this},t.toBacon=function(t){var e=this;return n().asap(function(){"undefined"!=typeof e.val()&&e.trigger("value")}),Bacon.fromBinder(function(i){return e.on("value",function(){i(t?t(e.val()):e.val())}),function(){}})},t.val=function(t){return"undefined"==typeof t?(("select"==this._type||"input"==this._type||"textarea"==this._type)&&(this._value=this._dom.value),this._value):(("undefined"!=typeof this._dom.value||"option"==this._type)&&(this._dom.value=t),this._value=t,this.trigger("value",t),this)}}(this),function(t){t.a=function(t,e){var i=this.shortcutFor("a",t,e);return i},t.attr=function(t,e){if(this.isObject(t))for(var i in t)t.hasOwnProperty(i)&&this.q.attr(i,t[i]);else this.q.attr(t,e);return this},t.b=function(t,e){var i=this.shortcutFor("b",t,e);return i},t.button=function(t,e){var i=this.shortcutFor("button",t,e);return i},t.canvas=function(t,e){var i=this.shortcutFor("canvas",t,e);return i},t.checkbox=function(t,e){var i=this.shortcutFor("checkbox",t,e);return i},t.ctx=function(){return this._dom.getContext?this._dom.getContext("2d"):void 0},t.div=function(t,e){var i=this.shortcutFor("div",t,e);return i},t.form=function(t,e){var i=this.shortcutFor("form",t,e);return i},t.h1=function(t,e){var i=this.shortcutFor("h1",t,e);return i},t.h2=function(t,e){var i=this.shortcutFor("h2",t,e);return i},t.h3=function(t,e){var i=this.shortcutFor("h3",t,e);return i},t.h4=function(t,e){var i=this.shortcutFor("h4",t,e);return i},t.img=function(t,e){var i=this.shortcutFor("img",t,e);return i},t.input=function(t,e){var i=this.shortcutFor("input",t,e);return i},t.label=function(t,e){var i=this.shortcutFor("label",t,e);return i},t.li=function(t,e){var i=this.shortcutFor("li",t,e);return i},t.ol=function(t,e){var i=this.shortcutFor("ol",t,e);return i},t.p=function(t,e){var i=this.shortcutFor("p",t,e);return i},t.pre=function(t,e){var i=this.shortcutFor("pre",t,e);return i},t.row=function(){var t=Array.prototype.slice.call(arguments);if("table"==this._tag)return this.addRow(t),this;var e=this.table();return e.addRow(t),e},t.shortcutFor=function(t){var e=_e(t);this.add(e);var i=[],n=[],r=[],o=Array.prototype.slice.call(arguments);o.shift();var s=this;return o.forEach(function(t){return 0==n.length&&"string"==typeof t?void n.push(t):0==n.length&&s.isStream(t)?void n.push(t):0==r.length&&s.isObject(t)&&!s.isFunction(t)?void r.push(t):0==i.length&&s.isFunction(t)?void i.push(t):void 0}),n.forEach(function(t){e.addClass(t)}),r.forEach(function(t){for(var i in t)t.hasOwnProperty(i)&&e.q.attr(i,t[i])}),i.forEach(function(t){t.apply(e,[e])}),e},t.span=function(t,e){var i=this.shortcutFor("span",t,e);return i},t.src=function(t){if("img"==this._tag&&!this._hasLoadL){var e=this;this.__singleton().addEventListener(this._dom,"load",function(){e.trigger("load")}),this._hasLoadL=!0}return this.q.attr("src",t),this},t.strong=function(t,e){var i=this.shortcutFor("strong",t,e);return i},t.table=function(t,e){var i=this.shortcutFor("table",t,e);return i},t.textarea=function(t,e){var i=this.shortcutFor("textarea",t,e);return i},t.ul=function(t,e){var i=this.shortcutFor("ul",t,e);return i}}(this),function(t){t._setDomText=function(t,e){if("undefined"!=typeof t.textContent)t.textContent=e;else{var i=e,n=document.createElement("div");n.innerHTML=i;var r=n.innerText||"";t.innerHTML=r}},t.html=function(t){if(this.isStream(t)){var e=this;return t.onValue(function(t){e.clear(),e.add(t)}),this}if(this.isFunction(t)){var i=t(),n=t(null,!0),e=this;return n.me.on(n.name,e.uniqueListener("text:value",function(t,i){e._dom.innerHTML=i})),this._dom.innerHTML=i,this}return"undefined"==typeof t?this._dom.innerHTML:(this._dom.innerHTML=t,this)},t.text=function(t){if("undefined"==typeof t)return this._html;var e=Array.prototype.slice.call(arguments);if(e.length>1){var i=!1,r=this;if(e.forEach(function(t){r.isObject(t)&&!r.isStream(t)&&(i=!0)}),i)return this.clear(),this.add(e),this;t=this.str(e)}if(this.isObject(t)&&t.onValue){var r=this;return t.onValue(function(t){if(r._svgElem||"undefined"!=typeof r._dom.textContent)r._dom.textContent=t;else{var e=t,i=document.createElement("div");i.innerHTML=e;var n=i.textContent||i.innerText||"";r._dom.innerHTML=n}r._html=t}),this}if(this.isFunction(t)){var o=t(),s=t(null,!0),r=this,a=(n(),!1);if("tspan"==r._tag&&(a=!0),this._svgElem||"undefined"!=typeof r._dom.textContent?s.me.on(s.name,r.uniqueListener("text:value",function(t,e){a&&(e=e.trim()),r._dom.textContent=!a||e&&0!=e.length?e:" "})):s.me.on(s.name,r.uniqueListener("text:value",function(t,e){var i=e,n=document.createElement("div");n.innerHTML=i;var o=n.textContent||n.innerText||"";r._dom.innerHTML=o})),this._svgElem||"undefined"!=typeof this._dom.textContent)a&&(o=o.trim()),!a||o&&0!=o.length?this._dom.textContent=o:(this._dom.textContent="",r._dom.textContent=" ");else{var h=document.createElement("div");h.innerHTML=o;var u=h.textContent||h.innerText||"";this._dom.innerHTML=u}return this}if(this._svgElem||"undefined"!=typeof this._dom.textContent)this._dom.textContent=t;else{var f=t,h=document.createElement("div");h.innerHTML=f;var u=h.textContent||h.innerText||"";this._dom.innerHTML=u}return this._html=t,this}}(this),function(t){var e,i,r,o,s,a,h,u,f;t.getRouteObj=function(){var t=document.location.hash.split("/"),e=function(t){for(var e={},i=0;i<t.length;i+=2)e[t[i]]=t[i+1];return e};return{hash:document.location.hash,parts:t.slice(),controller:t.shift().substring(1),action:t.shift(),params:e(t),rest:t}},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(){if(!i){var t=this;this.eventBinder(window,"hashchange",function(){"#"+i.lastSetValue!=document.location.hash&&(i.pushing||i.routers.forEach(function(e){e(t.getRouteObj())}))}),i={inited:!0,routers:[]},h={},f=[],u=[],this.onRoute(function(t){f.forEach(function(e){var i=e._pageController,n=i[t.controller]||i["default"];if(n){var r=n.ctrl[t.action]||n.ctrl["default"];r&&r.apply(n.canvas,[t.params,n.canvas,t])}})})}}),t.initScreenEvents=function(){r={w:0,h:0};var t=[700],e=0;if(o=[],window.matchMedia)s=window.matchMedia("(max-width:700px)"),s.addListener(function(t){e++,o.forEach(t.matches?function(t){t({w:window.innerWidth||document.documentElement.clientWidth,h:window.innerHeight||document.documentElement.clientHeight,limit:700,width_less:!0,eCnt:e})}:function(t){t({w:window.innerWidth||document.documentElement.clientWidth,h:window.innerHeight||document.documentElement.clientHeight,limit:700,width_more:!0,eCnt:e})})});else{var i=(document.addEventListener?!1:!0,window);this.eventBinder(i,"resize",function(){e++;var i=window.innerWidth||document.documentElement.clientWidth,n=!1,s=700;t.forEach(function(t){var e=(t-i)*(t-r.w);0>e&&(s=t,n=!0)}),r.w=window.innerWidth||document.documentElement.clientWidth,r.h=window.innerHeight||document.documentElement.clientHeight,n&&o.forEach(function(t){var i={limit:s,w:r.w,h:r.h,eCnt:e};r.w>s?i.width_more=!0:i.width_less=!0,t(i)})})}},t.onMediaChange=function(t){o.push(t)},t.onRoute=function(t){i.routers.push(t);var e=this;n().add(function(){t(e.getRouteObj())})},t.pageController=function(t,e){this._pageController||(this._pageController={}),this._pageController[t]={ctrl:e,canvas:this},f.indexOf(this)<0&&f.push(this)},t.popView=function(){if(console.log("popView"),!this._views||0==this._views.length)return console.log("pop View, no views to pop here"),this._parent?(console.log("calling parents popView"),this._parent.popView(),this):(this._views=[],this);var t=(new Date).getTime();if(!(a&&1e3>t-a)){a=t;var e=this,i=this._views.pop(),r=!0,o=this;this._poppedViews||(this._poppedViews=_e()),e.forChildren(function(t){t.removeClass("viewOut"),t.removeClass("viewIn"),t.addClass("viewOut"),r&&n().after(.2,function(){var t=[];i.oldChildren.forChildren(function(e){e.show(),t.push(e)}),t.forEach(function(t){e.add(t),t.removeClass("viewOut"),t.removeClass("viewIn"),t.addClass("viewIn")}),t[0]&&t[0].scrollTo(),i.oldTitle&&o.setTitle&&o.setTitle(i.oldTitle),r=!1,n().after(.2,function(){a=0})}),n().after(.2,function(){o._poppedViews.add(t)})})}},t.pushView=function(t,r){if(this._views||(this._views=[]),console.log("... trying pushing .... ",t),t!=this&&t!=e){console.log("... pushing view .... ",t);var o=this;if(o._children&&o._children[0]==t)return void console.log("... pushing view failed because this view had already the child view???.... ",t);this.isFunction(t)&&(t=t());var s=(new Date).getTime();if(!(a&&1e3>s-a)){a=s,r||(r=null);var h=_e(),u={parentView:null,oldTitle:this.__currentTitle,oldChildren:h,params:r},f=!0,c=!1,d=this;return this.onValue("pushView",function(t){d.pushView(t)}),this.onValue("popView",function(t){d.popView(t)}),e=this,o.forChildren(function(e){c=!0,n().after(.3,function(){t.removeClass("viewOut"),t.removeClass("viewIn"),t.addClass("viewIn"),o.add(t),t.show(),f=!1,n().after(.2,function(){a=0,t.scrollTo()})}),e.removeClass("viewIn"),e.removeClass("viewOut"),e.addClass("viewOut"),n().after(.2,function(){h.add(e)})}),this._views.push(u),c||n().after(.3,function(){t.removeClass("viewIn"),t.removeClass("viewOut"),t.addClass("viewIn"),o.add(t),t.show(),n().after(.2,function(){a=0,t.scrollTo()})}),i.pushing=!1,this}}},t.removeControllersFor=function(t){var e=f.indexOf(t);e>=0&&f.splice(e,1)},t.scrollTo=function(){if(window){var t=this.offset(),e=window.pageXOffset,i=t.top;if(i<window.innerHeight/2)return;t.top<window.innerHeight?i/=2:i-=.2*window.innerHeight,window.scrollTo(e||0,parseInt(i))}}}(this),function(t){t.createItemView=function(t){var e,i=this.getViewFunction(t),n=this;if(i&&(e=i(t),t.viewClass&&this.isFunction(t.viewClass))){var r=t.viewClass(null,!0),o=t.viewClass(),s=function(i,a){if(o!=a){var h=n.createItemView(t);o=a,e.replaceWith(h),e=h,r.me.removeListener(r.name,s)}};r.me.on(r.name,s)}return e},t.fromStream=function(t,e){var i=this;t.onValue(function(t){var r=e(t);n().add(function(){i.clear(),i.add(r)})})},t.getViewFunction=function(t){if(this.isFunction(this._view))return this._view;if(t.viewClass){var e;if(e=this._view[t.viewClass()])return e}for(var i in this._view)if(this._view.hasOwnProperty(i)){var e=this._view[i];if(this.isFunction(e))return e}},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(){}),t.mvc=function(t,e,i){var n=this;return e&&(this._view=e),t&&(this._model=t,this._model.on&&(this._model.on("insert",function(t,e){var i=n._model.item(e),r=n.createItemView(i);r&&n.insertAt(e,r)}),this._model.on("move",function(t,e){var i=n.child(e.from),r=n.child(e.to);r&&i&&(e.to<e.from?r.insertBefore(i):r.insertAfter(i))}),this._model.on("remove",function(t,e){var i=n.child(e);i&&i.remove()}),this._model.on("sort",function(t,e){if(0!=e.length&&!n.isObject(e[0][1])){for(var i=new Array,r=0;r<e.length;r++)e[r][1]!=e[r][2]?(i[r]=new Array(3),i[r][1]=n.child(e[r][1]),i[r][2]=n.child(e[r][2])):e[r][0]=null;for(var r=0;r<i.length;r++){var o=i[r][1],s=i[r][2],a=e[r][0];"a"==a&&s.insertBefore(o),"b"==a&&s.insertAfter(o)}}})),this._model.forEach&&this._model.forEach(function(t){var e=n.createItemView(t);e&&n.add(e)})),i&&(this._controller=i),this}}(this),function(t){t.circle=function(t,e){var i=this.shortcutFor("circle",t,e);return i},t.defs=function(t,e){var i=this.shortcutFor("defs",t,e);return i},t.feGaussianBlur=function(t,e){var i=this.shortcutFor("feGaussianBlur",t,e);return i},t.feMerge=function(t,e){var i=this.shortcutFor("feMerge",t,e);return i},t.feMergeNode=function(t,e){var i=this.shortcutFor("feMergeNode",t,e);return i},t.feOffset=function(t,e){var i=this.shortcutFor("feOffset",t,e);return i},t.filter=function(t,e){var i=this.shortcutFor("filter",t,e);return i},t.g=function(t,e){var i=this.shortcutFor("g",t,e);return i},t.image=function(t,e){var i=this.shortcutFor("image",t,e);return i},t.line=function(t,e){var i=this.shortcutFor("line",t,e);return i},t.path=function(t,e){var i=this.shortcutFor("path",t,e);return i},t.rect=function(t,e){var i=this.shortcutFor("rect",t,e);return i},t.svg=function(t,e){var i=this.shortcutFor("svg",t,e);return i},t.svg_text=function(t,e){var i=this.shortcutFor("text",t,e);return i},t.tspan=function(t,e){var i=this.shortcutFor("tspan",t,e);return i}}(this),function(t){t.guid=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},t.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},t.isFunction=function(t){return"[object Function]"==Object.prototype.toString.call(t)},t.isObject=function(t){return t===Object(t)},t.isStream=function(t){return this.isObject(t)&&t.onValue&&t.bufferWithTime?!0:!1},t.str=function(t){var e;e=this.isArray(t)?t:Array.prototype.slice.call(arguments);var i=!1,r=this,o=[];return e.forEach(function(t){r.isStream(t)?(i=!0,o.push("")):o.push(t)}),i?Bacon.fromBinder(function(t){return e.forEach(function(e,i){r.isStream(e)&&e.onValue(function(e){o[i]=e,t(o.join(""))})}),n().add(function(){t(o.join(""))}),function(){}}):e.join("")}}(this),function(t){var e;t.colorMix=function(t,e,i){var n=this.toRGB(t),r=this.toRGB(e),o=this.yuvConversion2(n,r,function(t,e){return{y:(1-i)*t.y+i*e.y,u:(1-i)*t.u+i*e.u,v:(1-i)*t.v+i*e.v}});return o},t.colorToHex=function(t){if("#"===t.substr(0,1))return t;var e=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(t),i=parseInt(e[2]),n=parseInt(e[3]),r=parseInt(e[4]),o=r|n<<8|i<<16;return e[1]+"#"+o.toString(16)},t.colourNameToHex=function(t){return"undefined"!=typeof e[t.toLowerCase()]?e[t.toLowerCase()]:!1},t.componentToHex=function(t){t=parseInt(t);var e=t.toString(16);return 1==e.length?"0"+e:e},t.dim=function(t,e){return this.yuvConversion(t,function(t){return t.y=t.y-e,t})},t.hexToRgb=function(t){if("#"==t[0]&&(t=t.substr(1)),3==t.length){var e=t;t="",e=/^([a-f0-9])([a-f0-9])([a-f0-9])$/i.exec(e).slice(1);for(var i=0;3>i;i++)t+=e[i]+e[i]}if(!t)return null;if(null!=t){var n=/^([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i.exec(t).slice(1);return{r:parseInt(n[0],16),g:parseInt(n[1],16),b:parseInt(n[2],16)}}},t.hexToYuv=function(t){var e=this;return e.rgbToYuv(e.toRGB(t))},t.hsvToRgb=function(t){var e,i,n,r,o,s,a,h,u=Math.max(0,Math.min(360,t.h)),f=Math.max(0,Math.min(100,t.s)),c=Math.max(0,Math.min(100,t.v));if(f/=100,c/=100,0==f)return e=i=n=c,{r:Math.round(255*e),g:Math.round(255*i),b:Math.round(255*n)};switch(u/=60,r=Math.floor(u),o=u-r,s=c*(1-f),a=c*(1-f*o),h=c*(1-f*(1-o)),r){case 0:e=c,i=h,n=s;break;case 1:e=a,i=c,n=s;break;case 2:e=s,i=c,n=h;break;case 3:e=s,i=a,n=c;break;case 4:e=h,i=s,n=c;break;default:e=c,i=s,n=a}return{r:Math.round(255*e),g:Math.round(255*i),b:Math.round(255*n)}},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(){e||(e={none:"#ffffff",aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"})}),t.rgbToHex=function(t){var e=this;return"#"+e.componentToHex(t.r)+e.componentToHex(t.g)+e.componentToHex(t.b)},t.rgbToHsv=function(t){var e,i,n,r,o,s=t.r/255,a=t.g/255,h=t.b/255,u=Math.max(s,a,h),f=u-Math.min(s,a,h),c=function(t){return(u-t)/6/f+.5};return 0==f?r=o=0:(o=f/u,e=c(s),i=c(a),n=c(h),s===u?r=n-i:a===u?r=1/3+e-n:h===u&&(r=2/3+i-e),0>r?r+=1:r>1&&(r-=1)),{h:Math.round(360*r),s:Math.round(100*o),v:Math.round(100*u)}},t.rgbToYuv=function(t){var e=t.r/255,i=t.g/255,n=t.b/255;return{y:.299*e+.587*i+.114*n,u:-.14713*e-.28885*i+.436*n,v:.615*e-.51499*i-.10001*n}},t.toRGB=function(t){if("object"==typeof t)return t;var e=this,i=e.colourNameToHex(t);return i||(i=e.colorToHex(t)),e.hexToRgb(i)},t.toRSpace=function(t){return Math.max(0,Math.min(255,Math.round(t)))},t.yuvConversion=function(t,e){var i=this,n=i.rgbToYuv(i.toRGB(t));n=e(n);var r=i.yuvToRgb(n);return i.rgbToHex(r)},t.yuvConversion2=function(t,e,i){var n=this,r=n.rgbToYuv(n.toRGB(t)),o=n.rgbToYuv(n.toRGB(e));r=i(r,o);var s=n.yuvToRgb(r);return n.rgbToHex(s)},t.yuvPixelConversion=function(t,e){var i=me.rgbToYuv(t);i=e(i);var n=me.yuvToRgb(i);return t.r=n.r,t.g=n.g,t.b=n.b,t},t.yuvToRgb=function(t){var e=t.y,i=t.u,n=t.v;return{r:this.toRSpace(255*(e+0*i+1.13983*n)),g:this.toRSpace(255*(e-.39465*i-.5806*n)),b:this.toRSpace(255*(e+2.03211*i))}}}(this),function(t){var i,n,r,s,a,h,u;t.__singleton=function(){return i},t.hasOwnProperty("__factoryClass")||(t.__factoryClass=[]),t.__factoryClass.push(function(t,e){if(t&&a&&a[t]){var i=a[t];return new i(t,e)}}),t.extendAll=function(e,i){if(this.isObject(e)){for(var n in e)e.hasOwnProperty(n)&&this.extendAll(n,e[n]);return this}return t[e]||(t[e]=i),this},t.getComponentRegistry=function(){return a},t.getElemNames=function(){return u},t.globalState=function(){var t={transform:"translate(-2000px,0px)"},e={transform:"translate(0,0)"};o().animation("viewOut",{duration:"0.4s","iteration-count":1},e,.5,t,t),o().animation("viewIn",{duration:"0.4s","iteration-count":1},t,.5,e,e),String.prototype.trim||!function(){var t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(t,"")}}();var i=n=function(){var t={},e={},i=!1,n=null,r=[],o=!1,s={x:0,y:0},a={sx:0,sy:0,dx:0,dy:0};t._cssfactor=1,t.domIndex={};t.addListener=function(i,n){e[i]||(e[i]=[]);var r=!1;return e[i].forEach(function(t){t==n&&(r=!0)}),r?void 0:(e[i].length>0?e[i][0]=n:e[i].push(n),t)},t.removeListener=function(i,n){if(e[i]){for(var r=e[i],o=r.length,s=0;o>s;s++){var a=r[s];if(a==n){e[i].splice(s,1);break}}return t}};var h=2;return t.popZ=function(){return h++},t.addEventListener=function(t,e,i){return e=e.toLowerCase(),t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i),!0},t.mouse=function(){return s},t.pxParam=function(t){if("string"==typeof t)return parseInt(t)+"px";var e=parseInt(t);return isNaN(e)?void 0:e+"px"},t.bexp=function(t,e){var i="";return i+="-o-"+t+":"+e+";\n",i+="-moz-"+t+":"+e+";\n",i+="-webkit-"+t+":"+e+";\n",i+=t+":"+e+";\n"},t.addEventListener(document,"mousemove",function(t){t=t||window.event,t.pageX?(s.x=t.pageX,s.y=t.pageY):(s.x=t.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),s.y=t.clientY+(document.documentElement.scrollTop||document.body.scrollTop)),i&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,a.dx=s.x-a.sx,a.dy=s.y-a.sy,n&&n.trigger("drag",a))}),t.setDragged=function(t){i=!0,n=t},t.dragMouseUp=function(){n&&n.trigger("enddrag",a),i=!1,n=null},t.dragMouseDown=function(e){if(o=!0,!i){var n=!1,h=[];if(e?h.push(e):(r.forEach(function(t){t.isHovering()&&h.push(t)}),h.sort(function(t,e){return t.z&&e.z?e.z()-t.z():0})),h[0]){var u=h[0],f=u.offset();return t.setDragged(u),a.sx=s.x,a.sy=s.y,a.dx=0,a.dy=0,a.x=f.left,a.y=f.top,n=!0,u.trigger("startdrag",a),!0}}},t.addEventListener(document,"mouseup",function(){t.dragMouseUp()}),t.addEventListener(document,"mousedown",function(e){t.dragMouseDown()&&(e=e||window.event,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1)}),t.draggable=function(t){r.push(t),t.isHovering();var e=t;t.touchevents(),t.on("touchstart",function(){var n=e.offset(),r=t.touch(0);a.sx=r.startX,a.sy=r.startY,a.dx=0,a.dy=0,a.x=r.startX-n.left,a.y=r.startY-n.top,i=!0,t.trigger("startdrag",a)}),t.on("touchmove",function(){var e=t.touch(0);a.dx=e.dx,a.dy=e.dy,i=!0,t.trigger("drag",a)}),t.on("touchend",function(){var e=t.touch(0);a.dx=e.dx,a.dy=e.dy,t.trigger("enddrag",a),i=!1})},t}();return i},t.__traitInit&&!t.hasOwnProperty("__traitInit")&&(t.__traitInit=t.__traitInit.slice()),t.__traitInit||(t.__traitInit=[]),t.__traitInit.push(function(t,e){this.initAsTag(t,e)}),t.initAsTag=function(t,o,u){if(this.isObject(t))this._dom=t,t=this._dom.tagName,"input"==t&&"checkbox"==this._dom.getAttribute("type")&&(t="checkbox");else if(t&&t.charAt&&"#"==t.charAt(0)){var f=document.getElementById(t.substring(1));f&&(t=f.tagName,this._dom=f)}a||(a={}),t||(t="div"),i||(this.initElemNames(),i=n=this.globalState(),s={circle:"true",rect:!0,path:!0,svg:!0,image:!0,line:!0,text:!0,tspan:!0,g:!0,pattern:!0,polygon:!0,polyline:!0,clippath:!0,defs:!0,feoffset:!0,femerge:!0,femergenode:!0,fegaussianblur:!0,filter:!0});var c="http://www.w3.org/2000/svg",d=t;if(t=t.toLowerCase(),u);else if(!h[t]&&!s[t])return void(this._invalidTag=t);r||(this.initScreenEvents(),r=!0),s[t]&&(this._svgElem=!0,this._svg=!0),this._type=t,this._tag=t.toLowerCase(),"checkbox"==this._type&&(this._checked=!1,this._tag="input"),this._children=[],"svg"==t&&(this._svg=!0),this._dom||("svg"==t?(this._dom=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._dom.setAttribute("xmlns","http://www.w3.org/2000/svg"),this._dom.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink")):this._dom=this._svgElem?document.createElementNS(c,d):document.createElement(this._tag)),this.q=new e(this._dom,this),"checkbox"==this._type&&this.q.attr("type","checkbox"),!this._component&&o&&"undefined"!=typeof o.appendChild&&o.appendChild(this._dom)},t.initElemNames=function(){h||(u=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","rt","ruby","s","sampe","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],h={},u.forEach(function(t){h[t]=!0}))},t.registerComponent=function(t,e){a[t]||(a[t]=e)}}(this)},_e=function(t,e,i,n,r,o,s,a){if(!(this instanceof _e))return new _e(t,e,i,n,r,o,s,a);var h=[t,e,i,n,r,o,s,a];if(this.__factoryClass){var u,f=this;if(this.__factoryClass.forEach(function(t){u=t.apply(f,h)}),"[object Function]"==Object.prototype.toString.call(u)){if(u._classInfo.name!=_e._classInfo.name)return new u(t,e,i,n,r,o,s,a)}else if(u)return u}if(this.__traitInit){var f=this;this.__traitInit.forEach(function(t){t.apply(f,h)})}else"function"==typeof this.init&&this.init.apply(this,h)};_e._classInfo={name:"_e"},_e.prototype=new _e_prototype,"undefined"!=typeof window&&(window._e=_e),"undefined"!=typeof window&&(window._e_prototype=_e_prototype);